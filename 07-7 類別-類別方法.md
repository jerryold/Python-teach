# 07-7 類別(class)-類別方法(class methods)


### 在類別中的方法前一行加上@classmethod, 即將該方法宣告為類別方法. 呼叫類別方法時, 第1個被自動帶入的參數就是該類別物件, 因此類別方法可以取用到類別中的類別變數及建構元等資源. 呼叫類別方法可以不必藉由類別生成的實例, 直接使用[類別名稱.類別方法名稱()]即可. 但若生成了實例, 用[實例名稱.類別方法名稱()]也同樣可呼叫類別方法.


#### (1)程式範例(宣告一個Student.departments的類別方法)

##### ntub.py
```python
#------------------------------------------------
# 定義學生類別
#------------------------------------------------
class Student():
    #------------------------------   
    # 類別變數       
    #------------------------------
    depts=['會資系', '財金系', '財稅系', '企管系', '商務系', '資管系', '應外系', '商設系', '商創系', '數媒系']
    
    #------------------------------       
    # 建構元
    #------------------------------   
    def __init__(self, stuNo, stuName, deptNo=None):
        self.stuNo=stuNo
        self.stuName=stuName
        self.deptNo=deptNo        

    #----------------------------------    
    # 取用deptNo屬性的方法
    #---------------------------------- 
    @property
    def deptNo(self):
        return self._deptNo

    #----------------------------------    
    # 寫入deptNo屬性的方法
    #---------------------------------- 
    @deptNo.setter
    def deptNo(self, deptNo):
        if deptNo in ['1', '2', '3', '4', '5', '6', '7', 'A', 'B', 'C']:
            self._deptNo=deptNo
        else:
            self._deptNo=None

    #----------------------------------    
    # 取出系名的方法
    # (取用類別變數)
    #----------------------------------  
    def department(self):
        if self._deptNo != None:
            if self._deptNo >= 'A':
                return Student.depts[ord(self._deptNo)-ord('A')+7]
            else:
                return Student.depts[ord(self._deptNo)-ord('1')]
        else:
            return None   
    
    #==================================
    # 類別方法, 判斷校區及系名.
    # 傳入: 系代號(str)
    # 回傳: 校區(str), 系名(str)    
    #==================================     
    @classmethod
    def departments(cls, idx):
        if idx in ['1', '2', '3', '4', '5', '6', '7']:
            return '臺北校區', Student.depts[ord(idx)-ord('1')]
        elif idx in ['A', 'B', 'C']:
            return '桃園校區', Student.depts[ord(idx)-ord('A')+7]
        else:
            return None, None            
```

##### main.py
```python
#---------------------------
# 匯入ntub模組
#---------------------------
import ntub

#---------------------------
# 將建成物件的原始資料
#---------------------------
data=[('10556001', '王小明', '6'), ('10552002', '陳小華', '2'), ('1055A003', '李小強', 'A'), ('10557004', '張小文', 'C'), ('10551005', '周小芳', '8')]

#---------------------------
# 將放置多個物件的list
#---------------------------
students=[]

#-----------------------------------------
# 生成Student類別的實例, 將它加入list中
#-----------------------------------------
for d in data:    
    students.append(ntub.Student(d[0], d[1], d[2]))
    
#---------------------------
# 逐一呼叫各個物件的方法
#---------------------------    
for s in students:    
    print('學號:{}  姓名:{}  系別:{}  系名:{}'.format(s.stuNo, s.stuName, s.deptNo, s.department()))

print('-'*40)

#==================================== 
# 呼叫Student的類別方法
#==================================== 
zone, dept = ntub.Student.departments('1')
print(zone, dept)

zone, dept = ntub.Student.departments('A')
print(zone, dept)
```


執行結果:
```
學號:10556001  姓名:王小明  系別:6  系名:資管系
學號:10552002  姓名:陳小華  系別:2  系名:財金系
學號:1055A003  姓名:李小強  系別:A  系名:商設系
學號:10557004  姓名:張小文  系別:C  系名:數媒系
學號:10551005  姓名:周小芳  系別:None  系名:None
----------------------------------------
臺北校區 會資系
桃園校區 商設系
----------------------------------------
```


### 由類別方法呼叫類別的建構元, 產生一個類別的實例:

#### (2)程式範例

##### ntub.py
```python
#------------------------------------------------
# 定義學生類別
#------------------------------------------------
class Student():
    #------------------------------   
    # 類別變數       
    #------------------------------
    depts=['會資系', '財金系', '財稅系', '企管系', '商務系', '資管系', '應外系', '商設系', '商創系', '數媒系']
    
    #------------------------------       
    # 建構元
    #------------------------------   
    def __init__(self, stuNo, stuName, deptNo=None):
        self.stuNo=stuNo
        self.stuName=stuName
        self.deptNo=deptNo        

    #----------------------------------    
    # 取用deptNo屬性的方法
    #---------------------------------- 
    @property
    def deptNo(self):
        return self._deptNo

    #----------------------------------    
    # 寫入deptNo屬性的方法
    #---------------------------------- 
    @deptNo.setter
    def deptNo(self, deptNo):
        if deptNo in ['1', '2', '3', '4', '5', '6', '7', 'A', 'B', 'C']:
            self._deptNo=deptNo
        else:
            self._deptNo=None

    #----------------------------------    
    # 取出系名的方法
    # (取用類別變數)
    #----------------------------------  
    def department(self):
        if self._deptNo != None:
            if self._deptNo >= 'A':
                return Student.depts[ord(self._deptNo)-ord('A')+7]
            else:
                return Student.depts[ord(self._deptNo)-ord('1')]
        else:
            return None   
    
    #==================================
    # 類別方法
    # 建立並回傳一個Student的實例.
    #==================================     
    @classmethod
    def generateInstanceFromTuple(cls, tup):
        if len(tup)==3:
            ins=cls(tup[0], tup[1], tup[2])
            return ins
        elif len(tup)==2:
            ins=cls(tup[0], tup[1])
            return ins
        else:
            return None        
```

##### main.py
```python
#---------------------------
# 匯入ntub模組
#---------------------------
from ntub import Student

#---------------------------
# 印出學生資訊的函式
#---------------------------
def printInfo(s):
    print('學號:{}  姓名:{}  系別:{}  系名:{}'.format(s.stuNo, s.stuName, s.deptNo, s.department()))   
    
    print('-'*50)   
    

#------------------------------------
# 由類別建立一個實例s1
#------------------------------------
s1=Student('110001', '王小明', '1')
printInfo(s1)

#------------------------------------
# 由類別方法建立一個實例s2(傳入tuple)
#------------------------------------
s2=Student.generateInstanceFromTuple(('110002', '陳小華', '2'))
printInfo(s2)

#------------------------------------
# 由類別方法建立一個實例s3(傳入tuple)
#------------------------------------
s3=Student.generateInstanceFromTuple(('110003', '李小強'))
printInfo(s3)
```


執行結果:
```
學號:110001  姓名:王小明  系別:1  系名:會資系
--------------------------------------------------
學號:110002  姓名:陳小華  系別:2  系名:財金系
--------------------------------------------------
學號:110003  姓名:李小強  系別:None  系名:None
--------------------------------------------------
```


### 類別變數存在類別物件中, 只有一份, 使用[類別名稱.類別變數名稱]取用; 實例變數存在各個實例中, 它們各自有各自的存放空間; 類別方法存在類別物件中, 可以直接以[類別名稱.類別方法()]呼叫, 或由[實例名稱.類別方法()]呼叫.

#### (3)程式範例

##### ntub.py
```python
#------------------------------------------------
# 定義一個計數器類別
#------------------------------------------------
class Counter():
    #-------------------------------------
    # 類別變數 
    #-------------------------------------  
    cnt=0
    
    #-------------------------------------
    # 複製類別變數cnt, 
    # 成為呼叫者(實例)自己的實例變數.
    #-------------------------------------
    def selfAdd(self):
        self.cnt=self.cnt+1
        return self.cnt
        
    #==========================================
    # 類別方法
    # 取用Counter類別中唯一一份的類別變數.
    #==========================================     
    @classmethod
    def add(cls):
        Counter.cnt=Counter.cnt+1
        return Counter.cnt
```

##### main.py
```python
#--------------------------------
# 匯入ntub模組內的Counter
#--------------------------------
from ntub import Counter

#--------------------------------
# 呼叫10次Counter.add()類別方法
#--------------------------------
print('**呼叫10次類別方法**')
for i in range(10):
    print(Counter.add())
    
print('-'*30)    

#--------------------------------
# 產生2個Counter類別的實例
#--------------------------------
a=Counter()    
b=Counter()

#--------------------------------
# 讓a, b呼叫自己的實例方法
#--------------------------------
print('**a, b呼叫自己的實例方法**')
print(a.selfAdd())
print(b.selfAdd())
print('-'*30)   

#--------------------------------
# 讓a, b呼叫類別方法
#--------------------------------
print('**a, b呼叫類別方法**')
print(a.add())
print(b.add())
print('-'*30) 
```


執行結果:
```
**呼叫10次類別方法**
1
2
3
4
5
6
7
8
9
10
------------------------------
**a, b呼叫自己的實例方法**
11
11
------------------------------
**a, b呼叫類別方法**
11
12
------------------------------
```

